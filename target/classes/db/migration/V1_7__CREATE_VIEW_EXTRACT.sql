CREATE VIEW expansive_control.VIEW_EXTRACT AS SELECT ft.ID as ID_FINANCIAL,ft.NAME as NAME,au.ID AS ID_CLIENT,
 CASE
    WHEN st.ACRONYM ='D' THEN -ft.VALUE
    ELSE ft.VALUE
 END  as TRANSACTIONS,
 st.ACRONYM as TYPE_TRANSACTION,
 ft.DATE_HOUR AS DATE_HOUR
FROM expansive_control.TB_FINANCIAL_MOVEMENT ft
INNER JOIN expansive_control.TB_SHABBY_TYPE st ON st.ID = RF_SHABBY_TYPE
INNER JOIN expansive_control.TB_AUTHENTICATE_USER au ON au.ID = RF_AUTHENTICATE_USER
INNER JOIN expansive_control.TB_PROFILE tp ON tp.ID = au.RF_PROFILE
WHERE tp.NAME = 'CLIENT'
GROUP BY DATE_HOUR,ID_FINANCIAL,NAME,ID_CLIENT,TYPE_TRANSACTION;